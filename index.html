<!DOCTYPE html>
<html>
<body>
<div id="all" style="overflow: auto; /*white-space: nowrap;*/" >

</div>


<p id="demo"></p>

<script>
    var tbl = document.createElement('table');
    tbl.setAttribute('border', '0');
    tbl.setAttribute('style', 'max-width:100%; white-space: nowrap;');

    var tbdy = document.createElement('tbody');
      var tbdy = document.createElement('tbody');
  var j = 0;
  for (var i = 0; i < 140; i++) {
    var tr = document.createElement('tr');
    for (var h = 0; h < 24; h++) {
        for(var m = 0; m<60; m+=5) {
            var mm = ''+m;
            if (mm.length == 1) {
                mm='0'+m;
            }
            var hh = ''+h;
            if (hh.length == 1) {
                hh='0'+h;
            }
            var td = document.createElement('td');
            //td.setAttribute('id', ''+i +'_'+ j);
            if (i > 0) {
                td.setAttribute('id', ''+i +'_'+ hh+':'+mm);
            } else {
                td.setAttribute('id', ''+i +'_' + j++);
            }

            //td.appendChild(document.createTextNode('' +i + '_' + j + '_slot: ' + Date.now() ))
            if (i == 0) {
                td.appendChild(document.createTextNode('' + hh +':' + mm ));
            }
            //td.appendChild(document.createTextNode('' +i + '_' + hh +':' + mm + '_' ))
            tr.appendChild(td)
        }
    }
    tbdy.appendChild(tr);
  }
  tbl.appendChild(tbdy);
  document.getElementById("all").appendChild(tbl)

    var myVar = setInterval(myTimer, 5000);

    function myTimer() {
    document.getElementById('0_'+Math.floor((new Date().getTime()/1000 - new Date().getTimezoneOffset()*60) % (86400) /300)).scrollIntoView();

    var xmlhttp = new XMLHttpRequest();
    xmlhttp.open("POST", "/");
    xmlhttp.setRequestHeader("Content-Type", "application/json");
    xmlhttp.onreadystatechange = function() { // Call a function when the state changes.
        if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
            var a = this.response;
            myArray = JSON.parse(JSON.parse(a).result);

            document.getElementById("demo").innerHTML = "";
            for(var i in myArray.sort()) {
            	if (Object.keys(myArray).length - 100  < i) {
                    var line = myArray[i].split(" ");
                    var id=line[0].split("_")[2];
                    var time=line[0].split("_")[1].substr(0, 5);
                    console.log(id+ ', '+ time);
                    document.getElementById(id + '_' + time).innerHTML = line[1] + ' ' + line[2];
                    //document.getElementById("demo").innerHTML = ' ' + line[0].split("_")[0] + ' <div style="display: inline-block;width:70px;">' + line[0].split("_")[1] + '</div><div style="display: inline-block;width:50px;">' +line[0].split("_")[2] + '</div>' + line[1] + ' ' + line[2] + '<br />' + document.getElementById("demo").innerHTML;
                }
            }
        }
    }
    xmlhttp.send(JSON.stringify({"jsonrpc": "2.0", "method": "get_tracks", "id":123 }));
      var d = new Date();
      //document.getElementById("demo").innerHTML = d.toLocaleTimeString();
    }
</script>

</body>
</html>


